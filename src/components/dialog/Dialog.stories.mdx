import {ArgsTable, Meta, Story, Canvas} from '@storybook/addon-docs';

import DialogA11y from './stories/Dialog.a11y.mdx';
import Dialog, {BaseDialogContainer, BaseDialogContent, BaseDialogOverlay, DialogContextProvider} from './Dialog';
import Button from '../buttons/Button';
import Flex from '../flex/Flex';
import Headline from '../text/Headline';
import Link from '../text/Link';
import DialogHeader from './DialogHeader';
import DialogBody from './DialogBody';
import DialogCloseButton from './DialogCloseButton';

<Meta
  title="Components/Dialog"
  component={Dialog}
  parameters={{
    docs: {
      /**
       * inlineStories=false causes an issue with DocsPage Controls
       * https://github.com/storybookjs/storybook/issues/11908
       */
      inlineStories: false,
      iframeHeight: 500,
    },
  }}
  argTypes={{
    children: {
      control: {
        disable: true,
      },
    },
    onDismiss: {
      action: 'onDismiss',
      table: {
        category: 'Events',
      },
    },
    onEntryTransitionEnd: {
      action: 'onEntryTransitionEnd',
      table: {
        category: 'Events',
      },
    },
    onExitTransitionEnd: {
      action: 'onExitTransitionEnd',
      table: {
        category: 'Events',
      },
    },
    open: {
      control: {
        disable: true,
      },
    },
  }}
  args={{
    open: false,
    reduceMotion: false,
  }}
/>

# Dialog

- [Accessibility](#accessibility)

## Overview

<Canvas>
  <Story name="Default">
    {args => {
      const [open, setOpen] = React.useState(false);
      const [anotherOpen, setAnotherOpen] = React.useState(false);
      const handleDismiss = () => setOpen(false);
      const handleDismissAnother = () => setAnotherOpen(false);
      const headerId = 'dialog-header';
      const anotherHeaderId = 'another-dialog-header';
      return (
        <div>
          <Button type="solid-mint" onClick={() => setOpen(true)}>
            open dialog
          </Button>
          <Dialog
            {...args}
            open={open}
            onDismiss={handleDismiss}
            labelledBy={headerId}
          >
            <DialogCloseButton onClick={handleDismiss} />
            <DialogHeader id={headerId}>
              <Flex marginBottom="m">
                <Headline>
                  Are you sure you want to stop asking this question?
                </Headline>
              </Flex>
            </DialogHeader>
            <DialogBody>
              <Flex marginBottom="m">
                Information you provide to us directly. We may collect personal
                information, such as your name, address, telephone number, date
                of birth, payment information, and e-mail address when you when
                you register for our Service, sign up for our mailing list,
                enter a contest or sweepstakes, or otherwise communicate with
                us. We may also collect any communications between you and
                Brainly and any other information you provide to Brainly
              </Flex>
              <Flex marginBottom="m">
                <Link
                  as="button"
                  onClick={() => setAnotherOpen(true)}
                  onKeyDown={({key}) => key === 'Enter' && setAnotherOpen(true)}
                >
                  Open another dialog
                </Link>
              </Flex>
              <Flex justifyContent="flex-end" className="sg-space-x-s">
                <Button type="outline" onClick={handleDismiss}>
                  cancel
                </Button>
                <Button type="solid">proceed</Button>
              </Flex>
            </DialogBody>
          </Dialog>
          <Dialog
            {...args}
            size="s"
            open={anotherOpen}
            onDismiss={handleDismissAnother}
            labelledBy={anotherHeaderId}
          >
            <DialogCloseButton onClick={handleDismissAnother} />
            <DialogHeader id={anotherHeaderId}>
              <Flex marginBottom="m">
                <Headline>
                  Are you really sure you want to stop asking this question?
                </Headline>
              </Flex>
            </DialogHeader>
            <DialogBody>
              <Flex justifyContent="flex-end" className="sg-space-x-s">
                <Button type="outline" onClick={handleDismissAnother}>
                  cancel
                </Button>
                <Button type="solid">proceed</Button>
              </Flex>
            </DialogBody>
          </Dialog>
        </div>
      );
    }}
  </Story>
</Canvas>

<ArgsTable story="Default"/>

## Accessibility

<DialogA11y />

## Stories

### With custom element before overlay

<Canvas>
    <Story name="WithCustomElementBeforeOverlay">
        {args => {
            const [open, setOpen] = React.useState(false);
            const handleDismiss = () => setOpen(false);
            const headerId = 'dialog-header';
            return (
                <div>
                    <Button type="solid-mint" onClick={() => setOpen(true)}>
                        open dialog
                    </Button>
                    <DialogContextProvider
                        {...args}
                        open={open}
                        onDismiss={handleDismiss}
                        labelledBy={headerId}>
                        <BaseDialogOverlay>
                            <div
                                style={{
                                    position: 'absolute',
                                    height: '100%',
                                    width: '100%',
                                    backgroundImage:
                                        "url('https://i.picsum.photos/id/350/1000/1000.jpg?hmac=K8UpYK9kXINCijZuHxZF1DIV9JVWMf7fCfuDL3Gtddc')",
                                    backgroundSize: 'cover',
                                }}
                            />
                            <BaseDialogContainer>
                                <BaseDialogContent>
                                    <DialogCloseButton onClick={handleDismiss}/>
                                    <DialogHeader id={headerId}>
                                        <Flex marginBottom="m">
                                            <Headline>
                                                Are you sure you want to stop asking this question?
                                            </Headline>
                                        </Flex>
                                    </DialogHeader>
                                    <DialogBody>
                                        <Flex marginBottom="m">
                                            Information you provide to us directly. We may collect personal
                                            information, such as your name, address, telephone number, date
                                            of birth, payment information, and e-mail address when you when
                                            you register for our Service, sign up for our mailing list,
                                            enter a contest or sweepstakes, or otherwise communicate with
                                            us. We may also collect any communications between you and
                                            Brainly and any other information you provide to Brainly
                                        </Flex>
                                        <Flex justifyContent="flex-end" className="sg-space-x-s">
                                            <Button type="outline" onClick={handleDismiss}>
                                                cancel
                                            </Button>
                                            <Button type="solid">proceed</Button>
                                        </Flex>
                                    </DialogBody>
                                </BaseDialogContent>
                            </BaseDialogContainer>
                        </BaseDialogOverlay>
                    </DialogContextProvider>
                </div>
            );
        }}
    </Story>
</Canvas>

### With custom element below dialog

<Canvas>
    <Story name="WithCustomElementBelowDialog">
        {args => {
            const [open, setOpen] = React.useState(false);
            const handleDismiss = () => setOpen(false);
            const headerId = 'dialog-header';
            return (
                <div>
                    <Button type="solid-mint" onClick={() => setOpen(true)}>
                        open dialog
                    </Button>
                    <DialogContextProvider
                        {...args}
                        open={open}
                        onDismiss={handleDismiss}
                        labelledBy={headerId}>
                        <BaseDialogOverlay>
                            <BaseDialogContainer>
                                <BaseDialogContent>
                                    <DialogCloseButton onClick={handleDismiss}/>
                                    <DialogHeader id={headerId}>
                                        <Flex marginBottom="m">
                                            <Headline>
                                                Are you sure you want to stop asking this question?
                                            </Headline>
                                        </Flex>
                                    </DialogHeader>
                                    <DialogBody>
                                        <Flex marginBottom="m">
                                            Information you provide to us directly. We may collect personal
                                            information, such as your name, address, telephone number, date
                                            of birth, payment information, and e-mail address when you when
                                            you register for our Service, sign up for our mailing list,
                                            enter a contest or sweepstakes, or otherwise communicate with
                                            us. We may also collect any communications between you and
                                            Brainly and any other information you provide to Brainly
                                        </Flex>
                                        <Flex justifyContent="flex-end" className="sg-space-x-s">
                                            <Button type="outline" onClick={handleDismiss}>
                                                cancel
                                            </Button>
                                            <Button type="solid">proceed</Button>
                                        </Flex>
                                    </DialogBody>
                                </BaseDialogContent>
                                <div style={{
                                    height: '250px', width: '970px', marginTop: '1rem', background: 'green', backgroundImage:
                                        "url('https://i.picsum.photos/id/473/970/250.jpg?hmac=qercOFBheyXUfKsZztEkkL06_o3_Ld-u7Xw4AGMd2wo')",
                                    backgroundSize: 'cover',
                                }}/>
                            </BaseDialogContainer>
                        </BaseDialogOverlay>
                    </DialogContextProvider>
                </div>
            );
        }}
    </Story>
</Canvas>
