import {ArgsTable, Meta, Story, Canvas} from '@storybook/addon-docs';
import Select, {SIZE as SELECT_SIZE, COLOR as SELECT_COLOR} from './Select';
import PageHeader from 'blocks/PageHeader';
import Button from '../buttons/Button';
import Text from '../text/Text';
import Flex from '../flex/Flex';

import Headline from '../text/Headline';
import {StoryVariant, StoryVariantTable} from '../../docs/utils';

<Meta
  title="Components/SelectNew"
  component={Select}
  argTypes={{
    defaultExpanded: {
      control: {
        type: 'boolean',
      },
    },
    size: {
      control: {
        type: 'select',
        options: SELECT_SIZE,
      },
    },
    color: {
      control: {
        type: 'select',
        options: SELECT_COLOR,
      },
    },
  }}
  args={{
    options: [
      {
        value: 'physics',
        label: 'Physics',
      },
      {value: 'history', label: 'History'},
      {value: 'science', label: 'Science'},
    ],
    disabled: false,
    size: SELECT_SIZE.M,
    color: SELECT_COLOR.DEFAULT,
  }}
/>

<PageHeader>Select</PageHeader>

- [Stories](#stories)

## Overview

<Canvas>
  <Story name="Default">{args => <Select {...args} />}</Story>
</Canvas>

<ArgsTable story="Default" />

## Stories

### With option select

<Canvas>
  <Story name="With option select">
    {args => {
      const [selectedOptions, setSelectedOptions] = React.useState([]);
      return (
        <div style={{width: '200px'}}>
          <Select
            {...args}
            selectedOptions={selectedOptions}
            onOptionChange={option => {
              setSelectedOptions([option]);
            }}
          />
        </div>
      );
    }}
  </Story>
</Canvas>

### Default expanded

<Canvas>
  <Story name="Default expanded">
    {args => {
      return (
        <div style={{width: '200px'}}>
          <Select {...args} defaultExpanded />
        </div>
      );
    }}
  </Story>
</Canvas>

### With icons

<Canvas>
  <Story
    name="With icons"
    args={{
      withIcons: true,
      options: [
        {value: 'physics', label: 'Physics', iconName: 'physics'},
        {value: 'history', label: 'History', iconName: 'history'},
        {value: 'science', label: 'Science', iconName: 'science'},
      ],
    }}
  >
    {args => {
      const [selectedOptions, setSelectedOptions] = React.useState([]);
      return (
        <div style={{width: '200px'}}>
          <Select
            {...args}
            selectedOptions={selectedOptions}
            onOptionChange={option => {
              setSelectedOptions([option]);
            }}
          />
        </div>
      );
    }}
  </Story>
</Canvas>

### With different select and popup lengths

<Canvas>
  <Story
    name="With different select and popup lengths"
    args={{
      withIcons: true,
      options: [
        {
          value: 'tv',
          label: 'Usłyszałem o Brainly w reklamie telewizyjnej w telewizji',
          iconName: 'physics',
        },
        {value: 'fb', label: 'Media społecznościowe', iconName: 'history'},
        {
          value: 'search',
          label: 'Wyszukiwarka internetowa',
          iconName: 'science',
        },
      ],
    }}
  >
    {args => {
      const [selectedOptions, setSelectedOptions] = React.useState({});
      return (
        <Flex direction="column" style={{gap: '20px'}}>
          <div style={{width: '200px'}}>
            <Text>With wide popup</Text>
            <Select
              {...args}
              selectedOptions={selectedOptions[0]}
              onOptionChange={option => {
                setSelectedOptions({...selectedOptions, 0: [option]});
              }}
            />
          </div>
          <div style={{width: '400px'}}>
            <Text>With wide input</Text>
            <Select
              {...args}
              options={[
                {
                  value: 'tv',
                  label: 'Usłyszałem',
                  iconName: 'physics',
                },
                {value: 'fb', label: 'Media', iconName: 'history'},
                {
                  value: 'search',
                  label: 'Wyszukiwarka',
                  iconName: 'science',
                },
              ]}
              placeholder="Select something from the list"
              selectedOptions={selectedOptions[1]}
              onOptionChange={option => {
                setSelectedOptions({...selectedOptions, 1: [option]});
              }}
            />
          </div>
          <div style={{width: '600px'}}>
            <Text>With short popup that stretches to 70% of the input</Text>
            <Select
              {...args}
              withIcons={false}
              options={[
                {
                  value: 'tv',
                  label: '1',
                },
                {value: 'fb', label: '2'},
                {
                  value: 'search',
                  label: '3',
                },
              ]}
              placeholder="Select something from the list"
              selectedOptions={selectedOptions[2]}
              onOptionChange={option => {
                setSelectedOptions({...selectedOptions, 2: [option]});
              }}
            />
          </div>
          <div>
            <Text>With short popup</Text>
            <div style={{width: '120px'}}>
              <Select
                {...args}
                withIcons={false}
                options={[
                  {
                    value: 'tv',
                    label: '1',
                  },
                  {value: 'fb', label: '2'},
                  {
                    value: 'search',
                    label: '3',
                  },
                ]}
                placeholder="Age"
                selectedOptions={selectedOptions[3]}
                onOptionChange={option => {
                  setSelectedOptions({...selectedOptions, 3: [option]});
                }}
              />
            </div>
          </div>
        </Flex>
      );
    }}
  </Story>
</Canvas>

### With multiple options select

<Canvas>
  <Story name="With multiple options select">
    {args => {
      const [selectedOptions, setSelectedOptions] = React.useState([]);
      const handleOptionChange = option => {
        // If it was not present, add it
        if (!selectedOptions.find(item => item.value === option.value))
          setSelectedOptions([...selectedOptions, option]);
        else {
          // else, remove from array of selected options
          setSelectedOptions(
            [...selectedOptions].filter(item => item.value !== option.value)
          );
        }
      };
      return (
        <div style={{width: '200px'}}>
          <Select
            {...args}
            selectedOptions={selectedOptions}
            onOptionChange={option => {
              handleOptionChange(option);
            }}
            multiSelect
          />
        </div>
      );
    }}
  </Story>
</Canvas>

### With preselected multiple options

<Canvas>
  <Story name="With preselected multiple options">
    {args => {
      const [selectedOptions, setSelectedOptions] = React.useState([
        args.options[1],
        args.options[2],
      ]);
      const handleOptionChange = option => {
        // If it was not present, add it
        if (!selectedOptions.find(item => item.value === option.value))
          setSelectedOptions([...selectedOptions, option]);
        else {
          // else, remove from array of selected options
          setSelectedOptions(
            [...selectedOptions].filter(item => item.value !== option.value)
          );
        }
      };
      return (
        <div style={{width: '200px'}}>
          <Select
            {...args}
            selectedOptions={selectedOptions}
            onOptionChange={option => {
              handleOptionChange(option);
            }}
            multiSelect
          />
        </div>
      );
    }}
  </Story>
</Canvas>

### With space constraints

<Canvas>
  <Story
    name="With space constraints"
    height="100%"
    args={{
      withIcons: true,
      options: [
        {
          value: 'tv',
          label: 'Usłyszałem o Brainly w reklamie telewizyjnej w telewizji',
          iconName: 'physics',
        },
        {value: 'fb', label: 'Media społecznościowe', iconName: 'history'},
        {
          value: 'search',
          label: 'Wyszukiwarka internetowa',
          iconName: 'science',
        },
        {
          value: 'search1',
          label: 'Wyszukiwarka internetowa',
          iconName: 'science',
        },
        {
          value: 'search2',
          label: 'Wyszukiwarka internetowa',
          iconName: 'science',
        },
        {
          value: 'search3',
          label: 'Wyszukiwarka internetowa',
          iconName: 'science',
        },
      ],
    }}
  >
    {args => {
      const [selectedOptions, setSelectedOptions] = React.useState([]);
      React.useEffect(() => {
        document.getElementById('selectId').scrollIntoView();
      }, []);
      return (
        <div>
          <Text>
            Scroll the layout vertically and horizontally and see how the Select
            position affects the popup position
          </Text>
          <div
            style={{
              border: '1px solid gray',
              height: '400px',
              width: '800px',
              overflow: 'scroll',
              resize: 'auto',
            }}
          >
            <Flex
              style={{
                height: '1000px',
                width: '2000px',
              }}
              direction="column"
              alignItems="center"
              justifyContent="center"
            >
              <div style={{width: '200px'}}>
                <Select
                  {...args}
                  id="selectId"
                  selectedOptions={selectedOptions}
                  onOptionChange={option => {
                    setSelectedOptions([option]);
                  }}
                />
              </div>
            </Flex>
          </div>
        </div>
      );
    }}
  </Story>
</Canvas>

### With long list

<Canvas>
  <Story
    name="With long list"
    height="100%"
    args={{
      options: [
        {value: 'physics', label: 'Physics'},
        {value: 'history', label: 'History'},
        {value: 'science', label: 'Science'},
        {value: 'physics2', label: 'Physics'},
        {value: 'history2', label: 'History'},
        {value: 'science2', label: 'Science'},
        {value: 'physics3', label: 'Physics'},
        {value: 'history3', label: 'History'},
        {value: 'science3', label: 'Science'},
        {value: 'physics4', label: 'Physics'},
        {value: 'history4', label: 'History'},
        {value: 'science4', label: 'Science'},
        {value: 'physics5', label: 'Physics'},
        {value: 'history5', label: 'History'},
        {value: 'science5', label: 'Science'},
        {value: 'physics6', label: 'Physics'},
        {value: 'history6', label: 'History'},
        {value: 'science6', label: 'Science'},
      ],
    }}
  >
    {args => {
      const [selectedOptions, setSelectedOptions] = React.useState([]);
      return (
        <div style={{width: '200px'}}>
          <Select
            {...args}
            selectedOptions={selectedOptions}
            onOptionChange={option => {
              setSelectedOptions([option]);
            }}
          />
        </div>
      );
    }}
  </Story>
</Canvas>

### Sizes

<Canvas>
  <Story
    name="Sizes"
    height="100%"
    args={{
      withIcons: true,
      options: [
        {
          value: 'art',
          label: 'Art',
          iconName: 'art',
        },
        {value: 'math', label: 'Math', iconName: 'mathematics'},
        {
          value: 'biology',
          label: 'Biology',
          iconName: 'biology',
        },
      ],
    }}
  >
    {args => {
      return (
        <Flex direction="row">
          {Object.values(SELECT_SIZE).map(size => (
            <Flex direction="column" style={{width: '200px', padding: '10px'}}>
              <Text>{size}</Text>
              <Select {...args} defaultExpanded size={size} />
            </Flex>
          ))}
        </Flex>
      );
    }}
  </Story>
</Canvas>

### Variants

<Canvas>
  <Story name="Variants">
    {args => (
      <div>
        <StoryVariantTable>
          <thead>
            <tr>
              <th />
              <th>
                <Headline
                  extraBold
                  transform="uppercase"
                  type="span"
                  color="text-gray-40"
                  size="medium"
                >
                  default
                </Headline>
              </th>
              <th>
                <Headline
                  extraBold
                  transform="uppercase"
                  type="span"
                  color="text-gray-40"
                  size="medium"
                >
                  disabled
                </Headline>
              </th>
              <th>
                <Headline
                  extraBold
                  transform="uppercase"
                  type="span"
                  color="text-gray-40"
                  size="medium"
                >
                  valid
                </Headline>
              </th>
              <th>
                <Headline
                  extraBold
                  transform="uppercase"
                  type="span"
                  color="text-gray-40"
                  size="medium"
                >
                  invalid
                </Headline>
              </th>
            </tr>
          </thead>
          <tbody>
            {Object.values(SELECT_SIZE).map(size => (
              <tr key={size}>
                <td>
                  <Headline
                    extraBold
                    transform="uppercase"
                    type="span"
                    color="text-gray-40"
                    size="medium"
                  >
                    SIZE="{size}"
                  </Headline>
                </td>
                <td>
                  <Flex justifyContent="center">
                    <Select key={size} {...args} size={size} />
                  </Flex>
                </td>
                <td>
                  <Flex justifyContent="center">
                    <Select key={size} {...args} size={size} disabled />
                  </Flex>
                </td>
                <td>
                  <Flex justifyContent="center">
                    <Select key={size} {...args} size={size} valid />
                  </Flex>
                </td>
                <td>
                  <Flex justifyContent="center">
                    <Select key={size} {...args} size={size} invalid />
                  </Flex>
                </td>
              </tr>
            ))}
            <tr
              key="color"
              style={{
                backgroundColor: '#000',
              }}
            >
              <td>
                <Headline
                  extraBold
                  transform="uppercase"
                  type="span"
                  color="text-gray-40"
                  size="medium"
                >
                  color="white"
                </Headline>
              </td>
              <td>
                <Flex justifyContent="center">
                  <Select {...args} color="white" />
                </Flex>
              </td>
              <td>
                <Flex justifyContent="center">
                  <Select {...args} color="white" disabled />
                </Flex>
              </td>
              <td>
                <Flex justifyContent="center">
                  <Select {...args} color="white" valid />
                </Flex>
              </td>
              <td>
                <Flex justifyContent="center">
                  <Select {...args} color="white" invalid />
                </Flex>
              </td>
            </tr>
          </tbody>
        </StoryVariantTable>
      </div>
    )}
  </Story>
</Canvas>

### Positioning

<Canvas>
  <Story
    name="Positioning"
    height="100%"
    parameters={{
      layout: 'fullscreen',
    }}
    args={{
      withIcons,
      options: [
        {value: 'art', label: 'Astronomy is great', iconName: 'art'},
        {
          value: 'math',
          label: 'Mathematics is my fav',
          iconName: 'mathematics',
        },
      ],
    }}
  >
    {args => {
      return (
        <Flex direction="column">
          <Flex
            direction="row"
            justifyContent="space-between"
            style={{height: '200px'}}
          >
            {[...Array(3)].map(number => (
              <div style={{width: '320px'}}>
                <Select
                  key={`long-${number}`}
                  {...args}
                  fullWidth={number % 2 ? false : true}
                />
              </div>
            ))}
          </Flex>
          <Flex
            direction="row"
            justifyContent="space-between"
            style={{height: '200px'}}
          >
            {[...Array(3)].map(number => (
              <div style={{width: '120px'}}>
                <Select
                  key={`short-${number}`}
                  {...args}
                  fullWidth={number % 2 ? false : true}
                />
              </div>
            ))}
          </Flex>
          <Flex
            direction="row"
            justifyContent="space-between"
            style={{padding: '0 30px', height: '300px'}}
          >
            {[...Array(3)].map(number => (
              <div style={{width: '120px'}}>
                <Select
                  key={`with-padding-${number}`}
                  {...args}
                  fullWidth={number % 2 ? false : true}
                />
              </div>
            ))}
          </Flex>
        </Flex>
      );
    }}
  </Story>
</Canvas>
