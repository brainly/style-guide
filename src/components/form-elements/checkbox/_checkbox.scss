$checkboxSize: 16px;
$checkboxPadding: 4px;
$checkboxClickableArea: 32px;

.sg-checkbox {
  --checkboxColor: #{$black};
  --checkboxHoverColor: #{$gray-60};
  --checkboxOutlineColor: #{$blue-40};
  --checkboxIconFillColor: #{$white};
  --checkboxLabelColor: #{$text-black};
  --checkboxCheckedColor: #{$black};
  --checkboxInvalidColor: #{$red-60};
  --checkboxInvalidHoverColor: #{$red-50};
  --checkboxInvalidIconFillColor: #{$white};

  @include component();

  display: flex;
  flex-direction: column;

  &--light {
    --checkboxColor: #{$white};
    --checkboxHoverColor: #{$gray-40};
    --checkboxOutlineColor: #{$blue-40};
    --checkboxIconFillColor: #{$black};
    --checkboxLabelColor: #{$text-white};
    --checkboxCheckedColor: #{$white};
    --checkboxInvalidColor: #{$red-40};
    --checkboxInvalidHoverColor: #{$red-50};
    --checkboxInvalidIconFillColor: #{$white};
  }

  &--with-padding {
    padding: $checkboxPadding 0;
  }

  @keyframes checkboxFadeOut1 {
    from {
      width: $checkboxSize;
      height: $checkboxSize;
    }

    to {
      width: calc($checkboxSize / 2);
      height: calc($checkboxSize / 2);
    }
  }
  @keyframes checkboxFadeOut2 {
    from {
      width: $checkboxSize;
      height: $checkboxSize;
    }

    to {
      width: calc($checkboxSize / 2);
      height: calc($checkboxSize / 2);
    }
  }

  @keyframes checkmarkAnimation {
    to {
      stroke-dashoffset: 0%;
    }
  }
  @keyframes checkmarkAnimation2 {
    to {
      stroke-dashoffset: 0%;
    }
  }

  &__wrapper {
    display: flex;

    &:hover {
      .sg-checkbox__icon {
        border-color: var(--checkboxHoverColor);
      }

      .sg-checkbox__input {
        &:checked,
        &:indeterminate {
          & + .sg-checkbox__icon {
            border-color: var(--checkboxHoverColor);
            background-color: var(--checkboxHoverColor);
          }
          &[aria-invalid] + .sg-checkbox__icon {
            background-color: var(--checkboxInvalidHoverColor);
          }
        }

        &[aria-invalid] + .sg-checkbox__icon {
          border-color: var(--checkboxInvalidHoverColor);
        }
      }
    }
  }

  &__content {
    display: flex;
    flex-direction: column;
    margin-left: calc($checkboxClickableArea + $checkboxPadding);
  }

  &__element {
    position: relative;
    width: $checkboxClickableArea;
    height: $checkboxClickableArea;
    display: inline-flex;
    flex-shrink: 0;
    align-items: center;
    justify-content: center;
  }

  &__input {
    width: 100%;
    height: 100%;
    position: absolute;
    opacity: 0;
    top: 0;
    left: 0;
    z-index: 1;

    &:focus-visible {
      & + .sg-checkbox__icon {
        border-color: var(--checkboxHoverColor);
        outline: 2px solid var(--checkboxOutlineColor);
        outline-offset: 2px;

        @media (forced-colors: active) {
          outline-color: Highlight;
        }
      }

      &[aria-invalid] + .sg-checkbox__icon {
        border-color: var(--checkboxInvalidHoverColor);
      }

      &:checked,
      &:indeterminate {
        &[aria-invalid] + .sg-checkbox__icon {
          border-color: var(--checkboxInvalidHoverColor);
          background-color: var(--checkboxInvalidHoverColor);
        }
      }
    }

    &:checked,
    &:indeterminate {
      & + .sg-checkbox__icon {
        border-color: var(--checkboxCheckedColor);
        background-color: var(--checkboxCheckedColor);
      }

      & + .sg-checkbox__icon--animate {
        animation-name: checkboxFadeOut2, checkboxFadeOut2;

        svg path {
          stroke-dashoffset: 0;
          stroke: var(--checkboxIconFillColor);
        }
      }

      &[aria-invalid] + .sg-checkbox__icon {
        border-color: var(--checkboxInvalidColor);
        background-color: var(--checkboxInvalidColor);
      }
    }

    &[aria-invalid] + .sg-checkbox__icon {
      border-color: var(--checkboxInvalidColor);
      fill: var(--checkboxInvalidIconFillColor);
    }
  }

  &__icon {
    width: $checkboxSize;
    height: $checkboxSize;
    border-radius: $borderRadiusSmall;
    border: 2px solid var(--checkboxColor);
    background-color: transparent;

    animation-name: checkboxFadeOut1, checkboxFadeOut1;
    animation-duration: 0.08s, 0.18s;
    animation-timing-function: cubic-bezier(0.3, 0, 1, 0.8);
    animation-delay: 0s, 0.08s;
    animation-direction: normal, reverse;

    transition: background-color 0s $easingRegular 0.08s;
    transition: border-color 0s $easingRegular;

    svg {
      position: absolute;
      left: 0;
      right: 0;
      top: 0;
      bottom: 0;
      margin: auto;
      stroke: var(--checkboxIconFillColor);
    }

    svg path {
      stroke-dasharray: 100%;
      stroke-dashoffset: 100%;
      transition: stroke-dashoffset 0.4s $easingRegular 0.08s;
    }

    svg .indeterminate-path {
      transition: stroke-dashoffset 0.6s $easingRegular 0.2s;
    }

    svg .indeterminate-path--left {
      transform: rotate(180deg) translateX(20px);
      transform-origin: right;
    }
  }

  @media (forced-colors: active) {
    .sg-checkbox__icon {
      fill: FieldText;
    }
  }

  &__label,
  &__description {
    color: var(--checkboxLabelColor);
    padding-right: 16px;
  }

  &__label {
    display: flex;
    padding-top: $checkboxPadding;
    padding-left: $checkboxPadding;

    &--with-padding-bottom {
      padding-bottom: $checkboxPadding;
    }
  }

  &__description,
  .sg-error-message {
    white-space: normal;
  }

  &--disabled {
    opacity: 0.45;
    cursor: not-allowed;
    pointer-events: none;

    @media (forced-colors: active) {
      .sg-checkbox__input + .sg-checkbox__icon {
        border-color: GrayText;
        fill: GrayText;
      }
    }
  }
}
