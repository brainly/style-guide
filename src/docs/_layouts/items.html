<!DOCTYPE html>
<html>
{% include head.html %}
<body>

<script src="images/icons.js" async></script>
<script src="images/subjects-icons.js" async></script>

{% include navigation.html %}
<div class="data-container">
    {% assign pageConfig=site.data.navigation[page.navigationIdx] %}

    <h1 class="main-header">Brainly style guide - {{ pageConfig.name }}</h1>

    {% for element in pageConfig.elements %}
    {% assign elementPath = 'components/' | append:element.location | append:'.html' %}

    <article>
      <h2 class="article-header" id="{{element.name | slugify}}">
        {{element.name}}
        <a href="#{{element.name | slugify}}" class="permalink">#</a>
      </h2>
      {% include {{elementPath}} %}
    </article>
    {% endfor %}
</div>

<div class="copy-helper copy-helper--hidden">
    <pre class="copy-helper__code-wrapper"><code class="copy-helper__code" id="sg-code"></code></pre>

    <div class="copy-helper__buttons">
        <button class="sg-icon-as-button sg-icon-as-button--dark js-grow-button copy-helper__button" title="Show more/less">
            <div class="sg-icon-as-button__hole">
                <svg class="sg-icon sg-icon--adaptive sg-icon--x22">
                    <use xlink:href="#icon-arrow_up"></use>
                </svg>
            </div>
        </button>

        <button class="sg-icon-as-button sg-icon-as-button--dark js-copy-button" title="Copy to the clipboard">
          <div class="sg-icon-as-button__hole">
            <svg class="sg-icon sg-icon--adaptive sg-icon--x22">
              <use xlink:href="#icon-answer"></use>
            </svg>
          </div>
        </button>
    </div>
</div>

<script>
  var copyHelper = document.querySelector('.copy-helper');
  var copyHelperCode = copyHelper.querySelector('.copy-helper__code');
  var copyButton = copyHelper.querySelector('.js-copy-button');
  var growButton = copyHelper.querySelector('.js-grow-button');

  hljs.configure({
    languages: ['html']
  });

  document.querySelector('.data-container').addEventListener('click', function (e) {
    var prevTarget = null;
    var target = e.target;

    while (target.tagName.toLowerCase() === 'use' || target.classList.toString().indexOf('sg-') !== -1) {
      prevTarget = target;
      target = target.parentNode;
    }

    if (prevTarget) {
      copyHelper.classList.remove('copy-helper--hidden');

      var markup = prevTarget.outerHTML;
      markup = markup.replace(/ xmlns:xlink="http:\/\/www\.w3\.org\/1999\/xlink"/g, '');
      copyHelperCode.innerText = markup;

      hljs.highlightBlock(copyHelperCode);
    } else {
      copyHelper.classList.add('copy-helper--hidden');
    }
  });

  new Clipboard(copyButton, {
    target: function() {
      return copyHelperCode;
    }
  });

  growButton.addEventListener('click', function() {
    growButton.classList.toggle('copy-helper__button--flip');
    copyHelper.classList.toggle('copy-helper--big');
  });
</script>

</body>
</html>
